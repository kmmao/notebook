# 第五阶段：组合数学（4-6周）

## 概述

组合数学是"计数的艺术"，是分析算法复杂度的数学基础。

---

## 1. 基本计数原理

### 加法原理
若A有m种方式，B有n种方式，且不重叠，则A或B有m+n种方式

### 乘法原理
若A有m种方式，B有n种方式，则A和B有m×n种方式

---

## 2. 排列与组合

### 排列（Permutation）

```
P(n,r) = n!/(n-r)! = n个中选r个，有序

P(n,n) = n!
```

### 组合（Combination）

```
C(n,r) = (n choose r) = n!/[r!(n-r)!] = n个中选r个，无序
```

### 重要性质

```
C(n,r) = C(n,n-r)                    // 对称性
C(n,r) = C(n-1,r-1) + C(n-1,r)       // 帕斯卡恒等式
Σ C(n,k) = 2ⁿ                        // 二项式系数和
```

### 二项式定理

```
(x+y)ⁿ = Σ C(n,k) x^k y^(n-k)
```

---

## 3. 多重集排列与组合

### 多重集排列
n个元素，有n₁个a₁，n₂个a₂，...

```
排列数 = n! / (n₁!n₂!...nₖ!)
```

### 多重集组合（隔板法）
从n种元素中选r个（可重复）

```
= C(n+r-1, r)
```

**推导**：想象r个球和n-1个隔板的排列

---

## 4. 容斥原理

```
|A₁∪A₂∪...∪Aₙ| = Σ|Aᵢ| - Σ|Aᵢ∩Aⱼ| + Σ|Aᵢ∩Aⱼ∩Aₖ| - ... + (-1)ⁿ⁺¹|A₁∩...∩Aₙ|
```

### 应用：错排问题

n个元素的错排数（没有元素在原位置）：

```
Dₙ = n! Σ (-1)ᵏ/k!  (k从0到n)
   ≈ n!/e
```

---

## 5. 鸽巢原理（进阶）

### 拉姆齐定理
R(m,n) = 最小的N，使得N个人中必有m人互相认识或n人互不认识

- R(3,3) = 6
- R(4,4) = 18
- R(5,5) 未知，介于43-48之间

---

## 6. 递推关系

### 线性递推

```
aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ... + cₖaₙ₋ₖ
```

**求解**：特征方程法

```
特征方程：xᵏ = c₁xᵏ⁻¹ + c₂xᵏ⁻² + ... + cₖ
通解：aₙ = α₁r₁ⁿ + α₂r₂ⁿ + ... （rᵢ是特征根）
```

### 斐波那契数列

```
Fₙ = Fₙ₋₁ + Fₙ₋₂
特征方程：x² = x + 1
特征根：φ = (1+√5)/2, ψ = (1-√5)/2
通解：Fₙ = (φⁿ - ψⁿ)/√5
```

---

## 7. 生成函数

### 普通生成函数（OGF）

```
序列 a₀, a₁, a₂, ... 的OGF：
G(x) = Σ aₙxⁿ
```

### 常见生成函数

```
1/(1-x) = 1 + x + x² + ...        // aₙ = 1
1/(1-x)² = Σ (n+1)xⁿ              // aₙ = n+1
eˣ = Σ xⁿ/n!                      // aₙ = 1/n!
```

### 应用
- 求解递推关系
- 计数问题

---

## 8. Catalan数

```
Cₙ = C(2n,n)/(n+1) = 1, 1, 2, 5, 14, 42, 132, ...
```

### 计数对象
- 合法括号序列
- 二叉树数量
- 凸多边形三角剖分
- 不穿过对角线的路径

---

## 9. Stirling数

### 第一类Stirling数 s(n,k)
n个元素分成k个环排列的方式数

### 第二类Stirling数 S(n,k)
n个元素分成k个非空子集的方式数

```
S(n,k) = k·S(n-1,k) + S(n-1,k-1)
```

---

## 10. Pólya计数

用于有对称性的计数（如项链、魔方状态）

```
|不等价的着色数| = (1/|G|) Σ m^c(g)

G = 对称群
c(g) = 置换g的轮换数
m = 颜色数
```

---

## 与算法的关系

| 组合概念 | 算法应用 |
|----------|----------|
| 排列组合 | 暴力枚举复杂度 |
| 递推关系 | 动态规划 |
| 生成函数 | 分析算法 |
| Catalan数 | 树、括号匹配 |
| 容斥原理 | 概率计算、计数 |

---

## 推荐资源

| 资源 | 内容 |
|------|------|
| Concrete Mathematics | Knuth等，经典中的经典 |
| Generatingfunctionology | 生成函数专著，免费在线 |
| Combinatorics (Brualdi) | 标准教材 |
